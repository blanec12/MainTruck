{% extends 'base.html'%}
{% block content%}
<!-- Primary User List -->
<div class="container">
  <h1>{{ title }}</h1>
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
      <div class="alert alert-{{category}}" role="alert">
          {{ message }}
      </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
  <button type="button" class="btn btn-outline-primary" data-toggle="modal" data-target="#user_modal">Create New User</button>
  <table id="data" class="table table-striped">
    <thead>
      <tr>
        <th>Username</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>IsAdmin</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for user in user_list %}
        <tr>
          <!-- {% if user.status %}
              <td>Active</td>
          {% else %}
              <td>Inactive</td>
          {% endif %} -->
          <td>{{ user.username }}</td>
          <td>{{ user.firstName }}</td>
          <td>{{ user.lastName }}</td>
          {% if user.isAdmin %}
            <td><input type="checkbox" name="isAdmin" value="{{ user.isAdmin}}" checked onclick="return false;"></td>
          {% else %}
            <td><input type="checkbox" name="isAdmin" value="{{ user.isAdmin }}" onclick="return false;"></td>
          {% endif %}
          <td><button type="button" class="btn btn-outline-primary" data-toggle="modal" data-target="#edit{{ user.id }}">Edit</button>
            <!-- Edit User Modal -->
            <form action="/admin/edit-user/{{user.id}}" method="POST">
              <div class="modal fade" id="edit{{ user.id }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Edit User</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <section class="edit-user-form container">
                                <form action='admin/edit-user' method="post">
                                    <div class="form-group">
                                      <label for="username">Username</label>
                                      <input class="form-control col-11 mdb-autocomplete" type="text" name="username" id="username" value="{{ user.username }}" readonly/>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="FName">First Name</label>
                                        <input class="form-control col-11 mdb-autocomplete" type="text" name="FName" id="FName" value="{{ user.firstName }}" required autofocus/>
                                    </div>

                                    <div class="form-group">
                                        <label for="LName">Last name</label>
                                        <input class="form-control col-11 mdb-autocomplete" type="text" name="LName" id="LName" value="{{ user.lastName }}" autofocus/>
                                    </div>

                                    <div class="form-group">
                                      <label for="password">Reset Password</label>
                                      <input class="form-control col-11 mdb-autocomplete" type="password" name="password" id="password" autofocus/>
                                    </div>

                                    <div class="form-group">
                                      <label for="isAdmin">Administrator</label>
                                      {% if user.isAdmin %}
                                        <input type="checkbox" name="isAdmin" checked="checked">
                                      {% else %}
                                        <input type="checkbox" name="isAdmin">
                                      {% endif %}
                                      
                                    </div>
                                </form>
                            </section>
                        </div>
                        
                        <div class="modal-footer">
                            <form action="/admin/del-user/{{user.id}}" method="POST" class="align-self-start mr-auto">
                              <button type="submit" class="btn btn-danger">Delete</button>
                            </form>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-dark">Save</button>
                        </div>
                    </div>
                </div>
              </div>
            </form>
            <!-- End Edit User Modal -->
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<!-- End Primary User List-->

<!-- Create New User Modal -->
<form action="/admin/create-user" method="POST">
  <div class="modal fade" id="user_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Create New User</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <section class="create-user-form container">
                    <form method="post">
                        <div class="form-group">
                            <label for="FName">First Name</label>
                            <input class="form-control col-11 mdb-autocomplete" type="text" name="FName" id="FName" required autofocus/>
                        </div>

                        <div class="form-group">
                            <label for="LName">Last name</label>
                            <input class="form-control col-11 mdb-autocomplete" type="text" name="LName" id="LName" autofocus/>
                        </div>

                        <div class="form-group">
                          <label for="username">Username</label>
                          <input class="form-control col-11 mdb-autocomplete" type="text" name="username" id="username" required autofocus/>
                        </div>

                        <div class="form-group">
                          <label for="password">Password</label>
                          <input class="form-control col-11 mdb-autocomplete" type="password" name="password" id="password" required autofocus/>
                        </div>

                        <div class="form-group">
                          <label for="isAdmin">Administrator</label>
                          <input type="checkbox" name="isAdmin">
                        </div>
                    </form>
                </section>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-dark">Save</button>
            </div>
        </div>
    </div>
  </div>
</form>
{% endblock %}